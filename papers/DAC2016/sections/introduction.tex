
%Building fault tolerant systems either requires full duplication of the system
%or a large amount of engineering effort in selecting the appropriate regions

%StitchUp provides a compiler flag for a HLS tool which will automatically 
%selectively duplicate the control flow of the input program

%Through replicating the control flow graph we are able to guarantee (via some 
%architectural assumptions) that in the presence of single event upsets the 
%circuit will either follow the correct path or flag an error.

% Automation claim
% CFG protection claim (Exhaustive bit testing)
% Area Saving claim
% Power saving claim


%FPGAs are great but have problems
FPGAs are an ideal candidate platform for aerospace and automotive applications
when there are strict constraints on performance and power, yet they are seldom used.
Two main issues prevent widespread adoption in these fields: firstly they are difficult
to program with designs taking many man-hours to build and verify;
and secondly they are highly susceptible to soft errors with single event upsets (SEU)
potentially causing unwanted device reconfiguration.
Research into High Level Synthesis (HLS) has been academically and commercially successful
at addressing the development time issues. HLS tools transform a popular programming language, such as C,
into a digital circuit replacing expensive specialised hardware engineers with software engineers.
However to address the issue of managing soft errors replication of the circuit and comparison logic is required
costing large amounts of additional resources and power, potentially causing the design to break constraints.

%Overview of our work
This paper presents StitchUp which extends the LegUp HLS tool \cite{canis2011legup} so that produced circuits are
guaranteed to terminate (provided the input does) even in the presence of SEUs, while always consuming equal or less logic than full circuit duplication.
In order to achieve this the tool determines the set of instructions required to make an exact duplicate of the Control
Flow Graph (CFG) ignoring instructions which only effect the data flow, creating what we shall refer to as a \emph{CFG shadow} circuit.
We argue that it is often the case that instructions which may influence the control flow of an application are more critical
than instructions which never effect control; for example, an image renderer which can tolerant errors within
it's pixel values but errors in it's control flow could cause it to hang indefinitely \cite{sampson2011enerj}.

The tool has three distinct stages: an analysis stage statically examines the input source and extracts any instruction
which potentially effects control; a CFG shadow generation stage consists of a modified LegUp backend
which takes the output of the analysis stage along with a description of the original schedule to produce a CFG shadow circuit;
finally a wrapper generation stage combines the original circuit, the CFG shadow circuit, and generates error detection logic;
Using this approach we are able to show that for certain applications we can guarantee that the CFG
is followed correctly, while consuming only 4\% of the resources required of standard Dual Modular Redundancy approaches.

%Below LEO
Until recently soft error concerns have primarily been contained within domains where
devices are placed in harsh radioactive conditions, such as satellites in low earth orbit, however
with shrinking device geometries this issue is set to become a problem for the entire
industry\cite{ibe2010impact}.
If terrestrial devices start to become increasingly effected by ground level radiation
then managing such faults is incredibly important especially in safety critical applications, such
as driverless cars.\\

%Typical Approaches are expensive, if you want to make guarantees
Protecting against soft errors is often achieved using N-Modular Redundancy, where N identical
versions of the module are executed, their outputs are compared and any differences in the
result indicate that a fault has occurred.


%We present a way to protect a subset of the circuit, while being able to make some guarantees


